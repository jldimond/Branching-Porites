epix <- fit$points[,1]
epiy <- fit$points[,2]
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
geno6 <- t(geno5)
ddist <- dist(geno6) # euclidean distances between the rows
ddfit <- cmdscale(ddist,eig=TRUE, k=2)
ddx <- ddfit$points[,1]
ddy <- ddfit$points[,2]
resid_t_binary <- t(resid_all_binary)
epidist <- dist(resid_t_binary) # euclidean distances between the rows
epifit <- cmdscale(epidist,eig=TRUE, k=2)
epix <- epifit$points[,1]
epiy <- epifit$points[,2]
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue", labels = row.names(resid_t_binary))
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
text(x, y, labels = row.names(resid_t_binary))
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
text(epix, epiy, labels = row.names(resid_t_binary))
View(Epidata5)
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
mtext('A', side=3, line=-1.6, at = 0.2, outer=TRUE)
mtext('B', side=3, line=-16.8, at = 0.2, outer=TRUE)
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
mtext('A', side=3, line=-1.6, at = 0.22, outer=TRUE)
mtext('B', side=3, line=-18, at = 0.22, outer=TRUE)
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
mtext('A', side=3, line=-1.6, at = 0.22, outer=TRUE)
mtext('B', side=3, line=-21, at = 0.22, outer=TRUE)
par(mfrow = c(2, 1))
par(mar = c(4, 4.5, 2, 1), oma = c(1, 1, 0, 0))
plot(ddx, ddy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
plot(epix, epiy, xlab="Coordinate 1", ylab="Coordinate 2", col = "blue")
mtext('A', side=3, line=-1.6, at = 0.22, outer=TRUE)
mtext('B', side=3, line=-20, at = 0.22, outer=TRUE)
resid_t_binary <- t(resid_all_binary)
Epigroups <- find.clusters(resid_t_binary, max.n.clust=10, n.pca = 24,
choose.n.clust = TRUE, criterion = "min")
dapc1 <- dapc(genind1, grp = Epigroups$grp)
dapc1 <- dapc(resid_t_binary, grp = Epigroups$grp)
scatter(dapc1, #label.inds = list(air = 0.1, pch = 0.5),
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright")
dapc1 <- dapc(genind1, pop = groups$grp, n.pca=9, n.da = 2)
scatter(Epidapc)
Epidapc1 <- dapc(resid_t_binary, grp = Epigroups$grp)
scatter(Epidapc1)
Epigroups <- find.clusters(resid_t_binary, max.n.clust=10, n.pca = 24,
choose.n.clust = TRUE, criterion = "min")
Epidapc1 <- dapc(resid_t_binary, grp = Epigroups$grp)
resid_t_diff <- t(resid2)
heatmap(resid_t_diff, scale = "none")
View(sinfo2)
View(resid_t_diff)
View(sinfo)
heatmap(resid_t_diff, scale = "none", labRow = sinfo$V1, labCol = FALSE)
View(resid_t_diff)
View(sinfo)
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE)
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = sinfo2$V5)
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groups$grp)
groups$grp
groupvec <- groups$grp[,c(2:10,12-27]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groups$grp)
#MDS of EpiRAD data with branch diam coloring
d <- dist(resid_t_binary) # euclidean distances between the rows
fit <- cmdscale(d,eig=TRUE, k=2)
x <- fit$points[,1]
y <- fit$points[,2]
#This adds a column of color values
# based on the y values
data_seq = seq(min(as.numeric(diam)), max(as.numeric(diam)), length=25)
col_pal = colorRampPalette(c('blue', 'green', 'red'))(25+1)
cols = col_pal[ cut(as.numeric(diam), data_seq, include.lowest=T) ]
text(x, y, labels = row.names(resid_t_binary),
col = cols, cex=.7)
points(x,y, col = cols, pch = 19)
layout(matrix(1:2,ncol=2), width = c(3,1),height = c(1,1))
plot(x, y, xlab="Coordinate 1", ylab="Coordinate 2",
main="Metric  MDS",  type="n")
points(x,y, col = cols, pch = 19)
legend_image <- as.raster(matrix(sort(cols, decreasing = TRUE), ncol=1))
plot(c(0,2),c(0,1),type = 'n', axes = F,xlab = '', ylab = '', main = 'branch diameter')
text(x=1.5, y = seq(0,1,l=5), labels = seq(6,26,l=5))
rasterImage(legend_image, 0, 0, 1,1)
###########################################################
#boxplot comparing branch diameter among groups from dapc
diam2 <- as.numeric(sinfo[,5])
boxplot(diam2 ~ dapc1$assign, xlab = "Group", ylab =  "diameter")
#ANOVA
#Run lm on diameter by group
model <- lm(diam2 ~ dapc1$assign)
#Check model (qq plot, etc)
par(mfrow=c(2,2))
plot(model)
library(lmtest)
#Breush Pagan Test for heteroscadisticity
bpt <- bptest(model)
print(bpt)
#Run ANOVA
aov <- anova(model)
print(summary(aov))
#pairwise t test with bonferonni adjustment
ttest <- pairwise.t.test(diam2, dapc1$assign, p.adj = "bonf")
print(ttest)
######################################################################
#Multiple regression: test linear model of depth, symbiont type, and
#branch diameter vs. dapc of SNPs using a single DA from the model above
#dapc with single DF
dapc1 <- dapc(genind1, pop = groups$grp, n.pca=9, n.da=1)
#Select # pcs = 9, # df = 1
scatter(dapc1)
#convert DF coord to vector
dapc1_da1 <- dapc1$ind.coord
#replace unknown symbiont type NAs to "U"
sinfo[is.na(sinfo)] <- "U"
#fit model with water depth (sinfo$V2), branch diameter (sinfo$V5),
# and symbiont type (sinfo$V4)
fit <- lm(na.omit(dapc1_da1 ~ as.numeric(sinfo$V2) + as.factor(sinfo$V4) + as.numeric(sinfo$V5)))
#Relative importance of different variables in model
library(relaimpo)
relimp <- calc.relimp(fit,type=c("lmg","last","first"),
rela=TRUE)
print(relimp)
# Bootstrap Measures of Relative Importance (1000 samples)
boot <- boot.relimp(fit, b = 1000, type = c("lmg", "last", "first"),
rank = TRUE, diff = TRUE, rela = TRUE)
booteval.relimp(boot) # print result
plot(booteval.relimp(boot,sort=TRUE)) # plot result
groupvec <- groups$grp[,c(2:10,12-27)]
groupvec <- groups$grp[c(2:10,12-27),]
groupvec <- groups$grp[c(2:10,12:27),]
groupvec <- groups$grp[,c(2:10,12:27)]
groupvec <- groups$grp[,2]
groupvec <- groups$grp[2,]
groups$grp
groupvec <- groups$grp[2,2]
groups$grp[2,2]
groups$grp[2,1]
groups$grp[1,1]
groups$grp[2,]
groupvec <- groups$grp
groupvec
groupvec[,1]
groupvec[1,1
}
groupvec[1,1]
groupvec[1]
groupvec <- as.numeric(groups$grp)
groupvec
groupvec <- as.numeric(groups$grp[,c(2:10,12:27)])
groupvec <- as.numeric(groups$grp[c(2:10,12:27),])
groupvec <- as.numeric(groups$grp[2:10,12:27])
groupvec <- as.numeric(groups$grp)
groupvec[,1]
groupvec[1,]
groupvec$1
groupvec[2,]
groupvec[2]
groupvec[c(2:10,12:27)]
groupvec2 <- groupvec[c(2:10,12:27)]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groupvec2)
groupvec <- as.character(groups$grp)
groupvec2 <- groupvec[c(2:10,12:27)]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groupvec2)
colors <- c("blue", "yellow", "red")(25)[groupvec2]
groupvec2 <- replace(groupvec2, which(groupvec2 == 1), "blue")
groupvec2 <- replace(groupvec2, which(groupvec2 == 2), "yellow")
groupvec2 <- replace(groupvec2, which(groupvec2 == 3), "red")
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groupvec2)
cols <- c("#edf8b1", "#7fcdbb", "#2c7fb8")
scatter(dapc1, col = cols,
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright")
scatter(dapc1, col = cols,
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright")
dapc1 <- dapc(genind1, pop = groups$grp, n.pca=9, n.da = 2)
cols <- c("#edf8b1", "#7fcdbb", "#2c7fb8")
scatter(dapc1, col = cols,
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright")
dapc1 <- dapc(genind1, pop = groups$grp, n.pca=9, n.da = 2)
cols <- c("#e66101", "#fdb863", "#5e3c99")
scatter(dapc1, col = cols,
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright")
#Plot cluster vs. BIC and DAPC together
par(mfrow = c(2, 1))
par(mar = c(6, 4.5, 2, 2), oma = c(1, 1, 1, 1))
plot(groups$Kstat, xlab = "Groups (K)", ylab = "BIC", pch = 16,
xaxp = c(1, 9, 4))
lines(groups$Kstat)
scatter(dapc1, #label.inds = list(air = 0.1, pch = 0.5),
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright",
cell=0, cstar=0, clab=0, cex=3, solid=.4, bg="white",
leg=TRUE, posi.leg="topleft", col = cols)
cols <- c("red", "orange", "purple")
scatter(dapc1, #label.inds = list(air = 0.1, pch = 0.5),
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright",
cell=0, cstar=0, clab=0, cex=3, solid=.4, bg="white",
leg=TRUE, posi.leg="topleft", col = cols)
resid_t_diff <- t(resid2)
groupvec <- as.character(groups$grp)
groupvec2 <- groupvec[c(2:10,12:27)]
groupvec2 <- replace(groupvec2, which(groupvec2 == 1), "red")
groupvec2 <- replace(groupvec2, which(groupvec2 == 2), "yellow")
groupvec2 <- replace(groupvec2, which(groupvec2 == 3), "purple")
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groupvec2)
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groupvec2, col = c("#fef0d9", "#fdcc8a"))
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groupvec2, col = c("#6baed6", "#08519c"))
groupvec2 <- groupvec[c(2:10,12:27)]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = groupvec2, col = c("#6baed6", "#08519c"))
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = sinfo2$V5, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('blue', 'green', 'red'))(25+1)
cols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = cols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('blue', 'green'))(25+1)
cols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = cols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('lightblue', 'green'))(25+1)
cols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = cols, col = c("#6baed6", "#08519c"))
rbPal <- colorRampPalette(c('red','blue'))
cols <- rbPal(10)[as.numeric(cut(sinfo2$V5,breaks = 10))]
diam2 <- as.numeric(sinfo2$V5)
cols <- rbPal(10)[as.numeric(cut(diam,breaks = 10))]
rbPal <- colorRampPalette(c('red','blue'))
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
cols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = cols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('darkred', 'lightblue'))(25+1)
cols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = cols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
cols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
diamcols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
heatmap(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = cols, col = c("#6baed6", "#08519c"))
install.packages("heatmap.plus")
library("heatmap.plus", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
myCols = cbind(groupvec2, diamcols)
myCols
groupvec <- as.character(groups$grp)
groupvec2 <- groupvec[c(2:10,12:27)]
groupvec2 <- replace(groupvec2, which(groupvec2 == 1), "red")
groupvec2 <- replace(groupvec2, which(groupvec2 == 2), "yellow")
groupvec2 <- replace(groupvec2, which(groupvec2 == 3), "purple")
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
diamcols = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
library("heatmap.plus")
myCols = cbind(groupvec2, diamcols)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = cols, col = c("#6baed6", "#08519c"))
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
View(myCols)
resid_t_diff <- t(resid2)
groupvec <- as.character(groups$grp)
SNP_Groups <- groupvec[c(2:10,12:27)]
SNP_Groups <- replace(groupvec2, which(groupvec2 == 1), "red")
SNP_Groups <- replace(groupvec2, which(groupvec2 == 2), "yellow")
SNP_Groups <- replace(groupvec2, which(groupvec2 == 3), "purple")
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
library("heatmap.plus")
myCols = cbind(groupvec2, diamcols)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
myCols = cbind(SNP_Groups, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
resid_t_diff <- t(resid2)
groupvec <- as.character(groups$grp)
SNP_Groups <- groupvec[c(2:10,12:27)]
SNP_Groups <- replace(groupvec2, which(groupvec2 == 1), "red")
SNP_Groups <- replace(groupvec2, which(groupvec2 == 2), "orange")
SNP_Groups <- replace(groupvec2, which(groupvec2 == 3), "purple")
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
library("heatmap.plus")
myCols = cbind(SNP_Groups, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
SNP_Groups <- replace(groupvec2, which(groupvec2 == 1), "red")
SNP_Groups <- replace(groupvec2, which(groupvec2 == 2), "orange")
SNP_Groups <- replace(groupvec2, which(groupvec2 == 3), "purple")
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
library("heatmap.plus")
myCols = cbind(SNP_Groups, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
myCols
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 1), "red")
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 2), "orange")
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 3), "purple")
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
library("heatmap.plus")
myCols = cbind(SNP_Groups, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
SNP_Groups <- groupvec[c(2:10,12:27)]
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 1), "red")
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 2), "orange")
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 3), "purple")
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
library("heatmap.plus")
myCols = cbind(SNP_Groups, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
seq("#000000", "#999999", length=20)
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#08519c", "#6baed6"))
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
diam2 <- as.numeric(sinfo[,4])
boxplot(diam2 ~ dapc1$assign, xlab = "Group", ylab =  "diameter")
model <- lm(diam2 ~ dapc1$assign)
par(mfrow=c(2,2))
plot(model)
library(lmtest)
bpt <- bptest(model)
print(bpt)
aov <- anova(model)
print(summary(aov))
ttest <- pairwise.t.test(diam2, dapc1$assign, p.adj = "bonf")
print(ttest)
genind1 <- read.structure("data3-2.str", n.ind = 27, n.loc = 1113,
onerowperind = FALSE, col.lab = 1,
NA.char = "-9", ask = FALSE,
row.marknames = 1, quiet = FALSE)
groups <- find.clusters(genind1, max.n.clust=10, n.pca = 24,
choose.n.clust = FALSE, criterion = "min")
xval <- xvalDapc(genind1@tab, groups$grp, n.pca.max = 25, training.set = 0.9,
result = "groupMean", center = TRUE, scale = FALSE,
n.pca = NULL, n.rep = 100, xval.plot = TRUE)
dev.off()
xval[2:6]
dapc1 <- dapc(genind1, pop = groups$grp, n.pca=9, n.da = 2)
scatter(dapc1, posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright")
par(mfrow = c(2, 1))
par(mar = c(6, 4.5, 2, 2), oma = c(1, 1, 1, 1))
plot(groups$Kstat, xlab = "Groups (K)", ylab = "BIC", pch = 16,
xaxp = c(1, 9, 4))
lines(groups$Kstat)
cols <- c("red", "orange", "purple")
scatter(dapc1, #label.inds = list(air = 0.1, pch = 0.5),
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright",
cell=0, cstar=0, clab=0, cex=3, solid=.4, bg="white",
leg=TRUE, posi.leg="topleft", col = cols)
par(mfrow = c(2, 1))
par(mar = c(6, 4.5, 2, 2), oma = c(1, 1, 1, 1))
plot(groups$Kstat, xlab = "Groups (K)", ylab = "BIC", pch = 16,
xaxp = c(1, 9, 4))
lines(groups$Kstat)
cols <- c("red", "orange", "purple")
scatter(dapc1, #label.inds = list(air = 0.1, pch = 0.5),
posi.da = "bottomleft", scree.pca = TRUE, posi.pca = "bottomright",
cell=0, cstar=0, clab=0, cex=3, solid=.4, bg="white",
leg=TRUE, posi.leg="topleft", col = cols)
diam2 <- as.numeric(sinfo[,4])
boxplot(diam2 ~ dapc1$assign, xlab = "Group", ylab =  "Diameter (mm)")
boxplot(diam2 ~ dapc1$assign, xlab = "Group", ylab =  "Diameter (mm)")
locator()
text(1.376804, 22.84152, "*")
text(1.376804, 22.84152, "*", cex = 2)
locator()
text(1.376804, 22.84152, "A", cex = 2)
text(1.990675, 13.63027, "B", cex = 2)
text(2.985303, 20.00729, "B", cex = 2)
boxplot(diam2 ~ dapc1$assign, xlab = "Group", ylab =  "Diameter (mm)")
text(1.376804, 22.84152, "A", cex = 1)
text(1.990675, 13.63027, "B", cex = 1)
text(2.985303, 20.00729, "B", cex = 1)
boxplot(diam2 ~ dapc1$assign, xlab = "Group", ylab =  "Diameter (mm)")
text(1.376804, 22.84152, "a", cex = 1)
text(1.990675, 13.63027, "b", cex = 1)
text(2.985303, 20.00729, "b", cex = 1)
resid_t_diff <- t(resid2)
#color pallet matrix for SNP groups and branch diam groups (in between whitespace)
groupvec <- as.character(groups$grp)
SNP_Groups <- groupvec[c(2:10,12:27)]
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 1), "red")
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 2), "orange")
SNP_Groups <- replace(SNP_Groups, which(SNP_Groups == 3), "purple")
col_pal = colorRampPalette(c('red', 'blue'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
set.seed(4)
contrib <- loadingplot(dapc1$var.contr, axis=1,
threshold= quantile(dapc1$var.contr,0.90), lab.jitter=1)
contrib
loci.90 <- gsub("\\..*","",contrib$var.names)
loci.90 <- unique(gsub("\\..*","",contrib$var.names))
View(resid_t_diff)
colnames(resid_t_diff)
loci.Epi <- as.numeric(colnames(resid_t_diff))
loci.Epi <- colnames(resid_t_diff)
loci_both[loci_both %in% intersect(loci.90, loci.Epi),]
intersect(intersect(loci.90,loci.Epi),)
intersect(intersect(loci.90,loci.Epi))
loci.both <- intersect(loci.90,loci.Epi)
loci.both
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('green', 'blue'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
library("heatmap.plus")
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
loci.90 <- unique(gsub("\\..*","",contrib$var.names))
col_pal = colorRampPalette(c('green', 'red'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
ol_pal = colorRampPalette(c('green', 'yellow'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('green', 'yellow'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('gray', 'black'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('green', 'dark red'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('green', 'red'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
col_pal = colorRampPalette(c('light gray', 'black'))(25+1)
Diameter = col_pal[ cut(as.numeric(sinfo2$V5), data_seq, include.lowest=T) ]
white <- colorRampPalette(colors= "#ffffff")
whitespace <- white(25)
myCols = cbind(SNP_Groups, whitespace, Diameter)
heatmap.plus(resid_t_diff, scale = "none", labRow = sinfo2$V1, labCol = FALSE,
RowSideColors = myCols, col = c("#6baed6", "#08519c"))
